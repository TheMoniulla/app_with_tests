%h1 Expenses
%p= link_to 'New expense', new_user_expense_path, class: 'btn btn-success'

%table.table.table-striped
  %tr
    %th Name
    %th Price
    %th Currency
    %th Description
    %th Shop
    %th Expense group
    %th Actions
  %h3= "#{name_of_week(date)}: #{date.beginning_of_week} - #{date.end_of_week}"
  - expenses_for_week.each do |expense|
    %tr
      %td= expense.name
      %td= expense.decorate.price
      %td= expense.currency.name
      %td= expense.decorate.description_for_display
      %td= expense.shop.name
      %td= expense.expenses_group.name
      %td
        = link_to 'Show', user_expense_path(expense.id)
        = link_to 'Edit', edit_user_expense_path(expense.id)
        = link_to 'Delete', user_expense_path(expense.id), method: :delete, data: {confirm: 'Are you sure?'}
  %tr
    %td TOTAL PRICE
    %td
      %b= price(current_user.total_price_for_week(date))
    %td
    %td
    %td
    %td
    %td
= link_to "#{name_of_week(date - 1.week)}", user_expenses_path(date: (date - 1.week).strftime('%Y-%m-%d'))
|
= link_to "#{name_of_week(date + 1.week)}", user_expenses_path(date: (date + 1.week).strftime('%Y-%m-%d'))

= link_to 'Send weekly report', send_expenses_mail_user_expenses_path(date: date.strftime('%Y-%m-%d')), class: 'btn btn-success'
- expenses_groups.each do |expenses_group|
  %h3= expenses_group.name
  %table.table.table-striped
    %tr
      %th Name
      %th Price
      %th Currency
      %th Description
      %th Shop
    - expenses_group.expenses.for_user(current_user).each do |expense|
      %tr
        %td= expense.name
        %td= expense.decorate.price
        %td= expense.currency.name
        %td= expense.decorate.description_for_display
        %td= expense.shop.name
    %tr
      %td TOTAL PRICE
      %td
        %b= price(expenses_group.total_price_for_user(current_user))
      %td
      %td
      %td
