%h1 Expenses
%p= link_to 'New expense', new_user_expense_path, class: 'btn btn-success'
%p= link_to 'Weekly expenses', user_weekly_expenses_path, class: 'btn btn-info'

%table.table.table-striped
  %tr
    %th Name
    %th Price
    %th Currency
    %th Description
    %th Shop
    %th Category
    %th Actions
  - expenses.each do |expense|
    %tr
      %td= expense.name
      %td= expense.decorate.price
      %td= expense.currency.name
      %td= expense.decorate.description_for_display
      %td= expense.shop.name
      %td= expense.expenses_category.name
      %td
        = link_to 'Show', user_expense_path(expense.id)
        = link_to 'Edit', edit_user_expense_path(expense.id)
        = link_to 'Delete', user_expense_path(expense.id), method: :delete, data: {confirm: 'Are you sure?'}
  %tr
    %td TOTAL PRICE
    %td
      %b= price(total_price(expenses))
    %td
    %td
    %td
    %td
    %td

- expenses_categories.each do |category|
  %h3= category.name
  %table.table.table-striped
    %tr
      %th Name
      %th Price
      %th Currency
      %th Description
      %th Shop
      %th Value %
    - category.expenses.for_user(current_user).each do |expense|
      %tr
        %td= expense.name
        %td= expense.decorate.price
        %td= expense.currency.name
        %td= expense.decorate.description_for_display
        %td= expense.shop.name
        %td= percentage_usage(expense, category.expenses.for_user(current_user))
    %tr
      %td TOTAL PRICE
      %td
        %b= price(category.total_price_for_user(current_user))
      %td
      %td
      %td
      %td
